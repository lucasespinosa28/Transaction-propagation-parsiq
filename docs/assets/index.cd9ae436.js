import{j as d,a as s,r as a,u as w,f as E,R as I,b as C,c as F}from"./vendor.38d48dd8.js";const L=function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))f(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&f(l)}).observe(document,{childList:!0,subtree:!0});function g(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerpolicy&&(o.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?o.credentials="include":e.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function f(e){if(e.ep)return;e.ep=!0;const o=g(e);fetch(e.href,o)}};L();const m={mainAddress:"0x0",apiKey:"AIzaSyAgFdIrPY7Rp0EFZiXwrC9-PHFo70Ca2Nk",sheetId:"1kRL5PcCf7AfjovWnP-dj3Aped3qH9XM8qzJtgXBPFcE"};function P(){return d("div",{className:"flex flex-col bg-gray-700 bg-opacity-50 rounded-t-lg mt-8",children:[s("h1",{className:"text-5xl text-gray-50 text-center m-2 w-full",children:"\u{1F52D}Transaction propagation watcher"}),s("div",{className:"flex justify-center",children:d("p",{className:"text-base break-all text-gray-50 text-center m-2 w-1/2",children:["monitor and visualise transaction propagation of Ethereum coins, started from",s("a",{className:"text-blue-500 hover:text-blue-300",href:`https://rinkeby.etherscan.io/address/${m.mainAddress}`,target:"_blank",children:m.mainAddress}),"and spreading across blockchain to different addresses."]})})]})}const O="https://rinkeby.etherscan.io",R=n=>`\u039E${n}`,i=n=>n.length>20?`${n.slice(0,6)}...${n.slice(-4)}`:n;function T(){const[n,c]=a.exports.useState(),[g,f]=a.exports.useState(),[e,o]=a.exports.useState(60),[l,y]=a.exports.useState(),[h,j]=a.exports.useState([]),{data:u,loading:b,error:v,refetch:k}=w({apiKey:m.apiKey,sheetId:m.sheetId});return console.log(),a.exports.useEffect(()=>{if(v===null&&b&&u.length>0&&u[0].data.length>0){const t=u[0].data;c(Object.assign({},...t.map(r=>({[`${i(r.from)}-${i(r.to)}`]:r.tx}))));const p=[{[i(t[0].from)]:t[0].from}].concat(t.map(r=>({[i(r.to)]:r.to})));f(Object.assign({},...p));const x=[{id:i(t[0].from)}].concat(t.map(r=>({id:i(r.to)}))).filter((r,N,$)=>$.findIndex(A=>A.id===r.id)===N);x.length<5?y(750):y(x.length*50);const S=t.map(r=>({sourceFull:r.from,source:i(r.from),target:i(r.to),targetFull:r.to,value:E(Number(r.value.replace(",",".")).toString())}));j({nodes:x,links:S})}},[h,u]),a.exports.useEffect(()=>{const t=setTimeout(()=>{o(e-1),e===0&&(o(60),k())},1e3);return()=>{clearTimeout(t)}},[e]),b&&h.length===0?s("div",{children:"Loading..."}):v?s("div",{children:"Error!"}):d("div",{className:"flex justify-center flex-col bg-gray-700 bg-opacity-50 rounded-b-lg",style:{height:l},children:[s("div",{className:"flex justify-center",children:d("button",{onClick:k,className:"rounded-md w-48 text-gray-900 bg-green-400 hover:bg-green-300 h-8 mt-2 text-center",children:["Refetch in ",e,"s"]})}),s(I,{data:h,margin:{top:40,right:160,bottom:40,left:50},valueFormat:R,layout:"vertical",align:"justify",colors:{scheme:"category10"},nodeOpacity:1,nodeHoverOthersOpacity:.35,nodeThickness:24,nodeSpacing:0,nodeBorderColor:{from:"color",modifiers:[["darker",.8]]},nodeBorderRadius:3,linkOpacity:.55,linkHoverOthersOpacity:.1,linkContract:3,linkBlendMode:"screen",enableLinkGradient:!0,labelPadding:-12,labelTextColor:"#ffffff",onClick:t=>{if(t.id&&window.open(`${O}/address/${g[t.id]}`),t.source&&t.target){let p=`${t.source.id}-${t.target.id}`;window.open(`${O}/tx/${n[p]}`,"_blank")}}})]})}C.render(d(F.StrictMode,{children:[s(P,{}),s(T,{})]}),document.getElementById("root"));
